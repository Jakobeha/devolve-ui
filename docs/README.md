[![License](https://img.shields.io/badge/License-Apache_2.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)

<img src="https://raw.githubusercontent.com/Jakobeha/devolve-ui/master/docs/assets/logo.svg" alt="logo" width='256'/>

# devolve-ui: super simple reactive graphics for browser and terminal

*Disclaimer: this is an early project. It's subject to change and have bugs*

**[Live demo](https://jakobeha.github.io/devolve-ui-demos/index.html) | [Clone to get started](https://github.com/Jakobeha/devolve-ui-demos)**

devolve-ui is a super simple graphics library for canvas-based websites (games) and TUIs. A single devolve-ui app can be embedded in a website *and* run on the command line via `node`.

devolve-ui is JSX-based like React, but renders to canvas or terminal instead of DOM. It should not be used for traditional web pages.

Example:

```jsx
// https://github.com/Jakobeha/devolve-ui-demos/src/readme.tsx
import { DevolveUI, useState, useInterval } from '@raycenity/devolve-ui'

const App = ({ name }) => {
  const [counter, setCounter] = useState(0)
  useInterval(1000, () => {
    setCounter(counter + 1)
  })

  return (
    <zbox width='100%'>
      <vbox x={2} y={2} gap={1}>
        <zbox width='100%'>
          <hbox width='100%'>
            <text color='white'>Hello {name}</text>
            <text color='white' x='100%' anchorX={1}>{counter} seconds</text>
          </hbox>
          <color color='orange' />
        </zbox>
        <source src='dog.png' width='100%' />
      </vbox>
      <border style='single' color='orange' width='prev + 4' height='prev + 4'/>
    </zbox>
  )
}

new DevolveUI(App, { name: 'devolve-ui' }).show()

// Works in node or browser (with additional pixi.js script)
```

<div style="display:flex;overflow-x:scroll">
  <img width='682' height='483' src="https://raw.githubusercontent.com/Jakobeha/devolve-ui/master/docs/assets/screenshots/terminal.png" alt="terminal" />
  <img width='682' height='553' src="https://raw.githubusercontent.com/Jakobeha/devolve-ui/master/docs/assets/screenshots/iterm.png" alt="iterm" />
  <img width='686' height='485' src="https://raw.githubusercontent.com/Jakobeha/devolve-ui/master/docs/assets/screenshots/browser.png" alt="browser" />
</div>

**Important setup information:** if adding to an existing project, besides installing, you *must* add this to your tsconfig.json for JSX support:

```json5
{
  /* ... */
  "jsx": "preserve", /** if using esbuild, otherwise "react" */
  "jsxImportSource": "@raycenity/devolve-ui"
}
```

**Pro tip:** If you debug TUIs in IntelliJ, you can see `console` outputs in a separate tab from the terminal output!

## Installing (with pnpm)

```bash
# if you don't have pnpm installed, uncomment the next line
# curl -fsSL https://get.pnpm.io/install.sh | sh -
pnpm add @raycenity/devolve-ui
```

### Repository info

devolve-ui is built using [esbuild](https://esbuild.org/). The package manager used is [pnpm](https://pnpm.io/). Linting is done by [standard](https://standardjs.com/), however we use a slightly modified version removing some warnings (`ts-standardx.mjs`). Docs are generated by [mkdocs](https://mkdocs.org). Feel free to submit issues / pull requests on the [Github](https://github.com/Jakobeha/devolve-ui).

## Features

### Cross-platform

devolve-ui is *cross-platform* (isomorphic): a devolve-ui application may run in both web browsers and terminals (via node.js). When the application is run in the terminal, graphics are much simpler and certain effects and animations are removed, hence the name "devolve"-ui.

When a devolve-ui application is run in the web browser, it uses pixi.js for rendering.

### Super simple

devolve-ui uses JSX and React-style **components**: you write your UI declaratively and use hooks (useState, useEffect, useLazy, useInput) for local state and side-effects. Your UI is literally a function which takes the global state, and returns a render of your application.

Unlike React, the **nodes** (lowercase components) which devolve-ui uses are not HTML elements, they are:

- `hbox`, `vbox`, `zbox`: Layout child components
  - `hbox`: Places children horizontally
  - `vbox`: Places children vertically
  - `zbox`: Places children on top of each other (no position offsets)
- `text`: Contains text
- `solid`: Renders a solid color
- `border`: Renders a border
- `source`: Renders an image, video, or other external graphic
- (WIP unstable) `pixi`: Can only be created via `PixiComponent`. These contain custom pixi components in the browser, and are invisible in TUIs.

Another notable difference is the layout system. devolve-ui does not use CSS, instead all node bounds are calculated using only the parent and previous child. As a result, you must specify bounds much more explicitly. See the [Implementation](#Implementation) section for more.

## Prompt-based GUI

Prompt-based GUI is a new-ish paradigm where your application interfaces with the UI via **prompts**.  devolve-ui has built-in support for prompt-based GUI via the `PromptDevolveUI` class. Read [*this article*](https://jakobeha.github.io/devolve-ui/docs/prompt-based-gui.md) for more.

## Implementation

[Source](https://github.com/Jakobeha/devolve-ui)

### Directory overview

- `core`: The main code of devolve-ui
  - `core/hooks`: Built-in hooks
  - `core/vdom`: The "DOM" in devolve-ui: nodes, attributes, and JSX.
- `renderer`: Platform-specific rendering
- `prompt`: [Prompt-based GUI](https://jakobeha.github.io/devolve-ui/docs/prompt-based-gui.md) helpers.

### Notable types

- `VNode`: Virtual "DOM" node, e.g. `box`, `text`, `color`
- `VComponent`: Synchronizes a component function to a persistent `VNode` and preserves state from hooks.
- `Bounds`: A node's bounds depend on the parent and previous component: therefore `Bounds` are literally a function from parent and previous component properties to a `BoundingBox`. See [src/core/vdom/bounds.ts](https://github.com/Jakobeha/devolve-ui/blob/tree/master/core/vdom/bounds.ts)
